<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>JINDE 錦德防水工程 - 專業請款單</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #333; padding: 20px; }
        .invoice-card { 
            width: 210mm; min-height: 297mm; margin: 0 auto; 
            background: white; padding: 40px 60px; position: relative;
        }
        .table-head { border-top: 2px solid #000; border-bottom: 2px solid #eee; }
        input { outline: none; border-bottom: 1px solid transparent; transition: 0.2s; }
        input:focus { border-bottom: 1px solid #ccc; background-color: #fafafa; }
        .unit-col { color: #888; font-weight: bold; width: 60px; text-align: center; }
        @media print {
            body { background: none; padding: 0; }
            .invoice-card { box-shadow: none; margin: 0; width: 100%; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body>

<div class="invoice-card shadow-2xl">
    <div class="flex justify-between items-start mb-20">
        <div>
            <h1 class="text-4xl font-black tracking-tighter">JINDE.</h1>
            <p class="text-xs tracking-widest text-gray-400 mt-1">錦德防水工程行</p>
        </div>
        <div class="text-right">
            <h2 class="text-6xl font-black text-gray-100 italic absolute right-16 top-10 select-none">INVOICE</h2>
            <p class="text-[10px] font-bold mt-12 relative z-10 text-gray-400 uppercase">Serial <span class="text-black ml-2" id="sn">INV-543440</span></p>
        </div>
    </div>

    <div class="grid grid-cols-2 gap-20 mb-16 text-sm">
        <div>
            <p class="text-[10px] font-black text-blue-600 uppercase mb-2 tracking-widest">Billed To 客戶</p>
            <input type="text" placeholder="Recipient Name" class="text-2xl font-bold w-full mb-1">
            <input type="text" placeholder="Project Description" class="text-gray-500 w-full italic">
        </div>
        <div class="text-right">
            <div class="mb-4">
                <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Date 發行日期</p>
                <p class="font-bold text-lg" id="currentDate">2026-01-28</p>
            </div>
            <div>
                <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Payment 匯款帳資</p>
                <p class="text-xs text-gray-500 leading-relaxed mt-1">
                    Bank: <span class="text-black font-bold italic">您的銀行代碼</span><br>
                    Acc: <span class="text-black font-bold italic">0000-0000-0000</span>
                </p>
            </div>
        </div>
    </div>

    <table class="w-full mb-10">
        <thead>
            <tr class="table-head text-[10px] font-black uppercase tracking-widest text-gray-500">
                <th class="py-4 text-left w-10">#</th>
                <th class="py-4 text-left">Description 項目</th>
                <th class="py-4 text-center">Unit 單位</th> <th class="py-4 text-center">Qty 數量</th>
                <th class="py-4 text-right">Price 單價</th>
                <th class="py-4 text-right">Amount 金額</th>
                <th class="py-4 w-10 no-print"></th>
            </tr>
        </thead>
        <tbody id="billBody">
            <tr class="border-b border-gray-50">
                <td class="py-6 text-gray-300 font-bold italic text-sm">01</td>
                <td class="py-6"><input type="text" value="工程進度款 / 第一期" class="w-full font-bold"></td>
                <td class="py-6 text-center"><input type="text" value="式" class="unit-col"></td> <td class="py-6 text-center"><input type="number" value="1" class="w-16 text-center font-bold qty" oninput="calc()"></td>
                <td class="py-6 text-right"><input type="number" value="0" class="w-24 text-right font-bold price" oninput="calc()"></td>
                <td class="py-6 text-right font-black text-lg subtotal">0</td>
                <td class="py-6 text-center no-print"><button onclick="this.parentElement.parentElement.remove();calc()" class="text-gray-200 hover:text-red-500 font-bold">✕</button></td>
            </tr>
        </tbody>
    </table>

    <button onclick="addRow()" class="no-print border border-gray-200 px-4 py-2 text-[10px] font-black rounded hover:bg-gray-50 uppercase tracking-widest text-gray-400 transition-all">+ Add Item 新增項目</button>

    <div class="flex justify-between items-end mt-20">
        <div class="w-1/2">
            <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2 italic">Notes 備註</p>
            <textarea class="w-full h-32 bg-gray-50 rounded p-4 text-xs text-gray-500 outline-none" placeholder="在此輸入條款或注意事項..."></textarea>
        </div>
        <div class="text-right">
            <div class="mb-6">
                <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest italic">Total Due 應付總額</p>
                <div class="flex items-baseline justify-end gap-2 mt-1">
                    <span class="text-xs text-gray-400 font-bold">TWD</span>
                    <span class="text-6xl font-black italic tracking-tighter" id="total">0</span>
                </div>
            </div>
            <div>
                <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest italic">In Words 中文大寫</p>
                <p class="text-xs font-bold mt-1 text-gray-400" id="totalChinese">零元整</p>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-2 gap-20 mt-32 pt-10 border-t border-gray-100 text-[10px] font-bold text-gray-300 uppercase tracking-[0.2em]">
        <div>
            <p class="mb-10 italic">Authorized</p>
            <p class="text-black italic">錦德防水工程行 簽署</p>
        </div>
        <div class="text-right">
            <p class="mb-10 italic">Client Acceptance</p>
            <p class="text-black italic">業主簽收確認</p>
        </div>
    </div>

    <div class="fixed bottom-10 right-10 no-print flex gap-4">
        <button onclick="window.print()" class="bg-black text-white px-8 py-3 rounded-full font-black text-sm shadow-2xl hover:scale-105 transition-all">PRINT 列印</button>
    </div>
</div>

<script>
    document.getElementById('currentDate').innerText = new Date().toISOString().split('T')[0];
    
    function addRow() {
        const tbody = document.getElementById('billBody');
        const count = tbody.children.length + 1;
        const num = count < 10 ? '0' + count : count;
        const tr = document.createElement('tr');
        tr.className = "border-b border-gray-50";
        tr.innerHTML = `
            <td class="py-6 text-gray-300 font-bold italic text-sm">${num}</td>
            <td class="py-6"><input type="text" placeholder="項目名稱" class="w-full font-bold"></td>
            <td class="py-6 text-center"><input type="text" value="坪" class="unit-col"></td>
            <td class="py-6 text-center"><input type="number" value="1" class="w-16 text-center font-bold qty" oninput="calc()"></td>
            <td class="py-6 text-right"><input type="number" value="0" class="w-24 text-right font-bold price" oninput="calc()"></td>
            <td class="py-6 text-right font-black text-lg subtotal">0</td>
            <td class="py-6 text-center no-print"><button onclick="this.parentElement.parentElement.remove();calc()" class="text-gray-200 hover:text-red-500 font-bold">✕</button></td>
        `;
        tbody.appendChild(tr);
    }

    function calc() {
        let grandTotal = 0;
        const rows = document.querySelectorAll('#billBody tr');
        rows.forEach(row => {
            const qty = parseFloat(row.querySelector('.qty').value) || 0;
            const price = parseFloat(row.querySelector('.price').value) || 0;
            const sub = qty * price;
            row.querySelector('.subtotal').innerText = sub.toLocaleString();
            grandTotal += sub;
        });
        document.getElementById('total').innerText = grandTotal.toLocaleString();
        document.getElementById('totalChinese').innerText = numberToChinese(grandTotal);
    }

    function numberToChinese(n) {
        if (n === 0) return "零元整";
        const digit = ['零', '壹', '貳', '參', '肆', '伍', '陸', '柒', '捌', '玖'];
        const unit = [['元', '萬', '億'], ['', '拾', '佰', '仟']];
        let s = '整'; n = Math.floor(n);
        for (let i = 0; i < unit[0].length && n > 0; i++) {
            let p = '';
            for (let j = 0; j < unit[1].length && n > 0; j++) {
                p = digit[n % 10] + (n % 10 !== 0 ? unit[1][j] : '') + p;
                n = Math.floor(n / 10);
            }
            s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;
        }
        return s.replace(/(零.)*零元/, '元').replace(/(零.)+/g, '零').replace(/^元/, "零元");
    }
</script>

</body>
</html>
